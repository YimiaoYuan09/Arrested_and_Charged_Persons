---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - Yimiao Yuan
thanks: "Code and data are available at: LINK."
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

# load the packages
library(tidyverse)
```


# Introduction

You can and should cross-reference sections and sub-sections. 

The remainder of this paper is structured as follows. @sec-data....



# Data {#sec-data}

the source of the data and the broader context that gave rise to it

This report uses "Police Annual Statistical Report - Arrested and Charged Persons" as the primary dataset, which obtained from the City of Torontoâ€™s Open Data Portal (@CityofToronto). This dataset was accessed through R (@citeR) using opendatatoronto package (@opendatatoronto) and saved using readr (@readr). 

```{r}
#| echo: false

# read in the data
cleaned_arrested_person <- read_csv(here::here("outputs", "data", "cleaned_arrested_person_data.csv"),
                                    show_col_types = FALSE)
```

describe and summarize the data using text, graphs, and tables

```{r}
#| echo: false

count_arrested_person_year <-
  cleaned_arrested_person |>
  group_by(arrest_year) |>
  summarise(count_arrest_year = sum(num_of_arrested_person))
```


Some of our data is of penguins (@fig-year), from @palmerpenguins.

```{r}
#| label: fig-year
#| fig-cap: Number of arrested and charged person each year
#| echo: false

count_arrested_person_year |>
  ggplot(aes(x = arrest_year, y = count_arrest_year)) +
  geom_bar(stat = "identity") +
  scale_x_continuous(breaks = c(2014, 2016, 2018, 2020, 2022)) +
  theme_minimal() +
  ggtitle("Number of arrested and charged person per year") +
  labs(x = "Year", y = "Number of arrested and charged person")
```

Talk more about it.

And also planes (@fig-sex). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)

```{r}
#| echo: false
#| warning: false
count_arrested_person_sex <-
  cleaned_arrested_person |>
  select(arrest_year, sex, num_of_arrested_person) |>
  group_by(arrest_year, sex) |>
  summarise(count_arrest_sex = sum(num_of_arrested_person))
```


```{r}
#| label: fig-sex
#| fig-cap: Number of arrested and charged person per gender each year
#| echo: false
#| warning: false
#| message: false

ggplot(count_arrested_person_sex, aes(x = arrest_year, y = count_arrest_sex, 
                                      group = sex, color = sex)) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  ggtitle("Number of arrested and charged person by gender") +
  labs(x = "Year", y = "Number of arrested and charged person", color = "Gender")
```

Talk way more about it. 

Some of our data is of penguins (@fig-division)

```{r}
count_arrested_person_div <-
  cleaned_arrested_person |>
  group_by(arrest_year, division) |>
  summarise(count_arrest_div = sum(num_of_arrested_person))
```

```{r}
#| label: fig-division
#| fig-cap: Number of arrested and charged person per division each year
#| echo: false
#| warning: false
#| message: false

ggplot(count_arrested_person_div, aes(x = division, y = count_arrest_div, 
                                      group = arrest_year, fill = arrest_year)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  ggtitle("Number of arrested and charged person by location of crime") +
  labs(x = "Division", y = "Number of arrested and charged person", fill = "Arrested year")
```

Talk way more about it. 

Some of our data is of penguins (@fig-age)

```{r}
#| echo: false
count_arrested_person_age <-
  cleaned_arrested_person |>
  group_by(age, sex) |>
  summarise(count_arrest_age = sum(num_of_arrested_person))
```

```{r}
#| label: fig-age
#| fig-cap: Number of arrested and charged person per age group each year
#| echo: false

ggplot(count_arrested_person_age, aes(x = age, y = count_arrest_age, 
                                      group = sex, fill = sex)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  ggtitle("Number of arrested and charged person by age group") +
  labs(x = "Age", y = "Number of arrested and charged person", fill = "Gender")
```


Our results are summarized in @tbl-modelresults.



If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 


## Weaknesses and next steps

Weaknesses and next steps should also be included.


\newpage


# References


